# 脑电信号分析(时域、频域及空间分布)

## 目的

- 学习脑电信号的预处理过程

- 观察脑电信号的时域及频域特征，观察脑电信号的谐波分布，并与原论文进行对照

- 通过观察空间地图理解大脑响应的空间特征

## 过程

### 时频分析

#### 预处理

1. 首先原数据的形式为(# channels, # samples, # targets, # blocks)的4D矩阵，为了数据处理方便，做转置，变为(# targets, # channels, # samples, # blocks)

2. 由于后续还需要经过带通滤波，直流分量本身就会被滤除，所以不需要再进行基线校准

3. 原数据集已经做完segmentation，每次激励对应的响应单独存储为一个向量。向量所对应的前0.5s为视线移动到选定目标上所用的时间，而后又需要0.13s的反应时间，所以前0.63s的数据不能作为有效的脑电信号，可以用作基线校准等用途。为了避免响应末尾信号衰减的干扰，我设定结束时间为5s，所以相当于对每个响应，我取0.63s\~5s之间的数据作为有效数据进行观察。
   `eeg = eeg[:,:,offset_len:end_len,:]`

4. 为了减少数据量，我在时频分析时每次只取一个target对应的一个通道的数据

5. 由于激励在8\~15.8Hz之间，我选取通带为7\~70Hz(带内衰减不超3dB)，在6Hz和78Hz分别达到40dB衰减的切比雪夫I型带通滤波器来对信号进行双向滤波，排除了通带外的干扰，没有相位失真，而且这样足够观察到15.8Hz的4次谐波分量。
![Cheby1](.\imgs\Cheby1.png)

#### 时域分析

**S3**

![Figure_1](.\imgs\Figure_1.png)

可以看到经过滤波后的信号较为平滑，高频和低频的干扰滤除较为干净。在时域难以看出信号的更多信息，对SSVEP的分析主要从频域入手。

#### 频域分析

**S3**

![Figure_2](.\imgs\Figure_2.png)

在频域可以明显地看出信号主要集中在基频14.65Hz及其高次谐波分量上。可以判断出激发出此受迫相应的激励信号频率应该在14.65Hz附近。由于没有对多人的数据做平均，所以在其他频率上有一些噪声，但整体的基频和谐波分量仍较明显。另外，数据集的说明中提到使用了50Hz的带阻滤波预处理了数据(消除市电影响)，可以看到在50Hz左右有一个较为明显的凹陷。

#### 空间域分析

**S3**

![S3_topo_target31](.\imgs\S3_topo_target31.png)

截取该subject在[3.0: 0.5: 4.5]s的全通道脑电数据(经过与之前相同的转置和滤波)，可以看到在3.5s和4.0s两个时间点上，负责视觉的枕叶脑区相对活跃，Oz, O1, O2通道的数值最高，附近次之。这说明视觉诱发电位(VEP)主要出现在负责视觉的枕叶，也解释了为什么之前在TRCA的那篇论文中使用了Pz,PO5,PO3,POz,PO4,PO6,O1,Oz,O2共九个通道。

## 总结

这次观察的信号为SSVEP信号，属于视觉的诱发电位，应该重点考察枕叶视觉区的脑电信号。由于是稳态诱发电位，主要从频域考察其特征，观察其基频和谐波。
